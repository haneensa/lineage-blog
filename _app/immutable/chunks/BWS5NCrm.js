import{n as R,o as L,q as S,v as M,w as T,x as I,y as P,z as w,A as B,B as N,C as k,D as Y,E as x,F,H as C,G as U,I as q,J as y,K as z,P as G,g as m,L as H,M as $,N as J,O as K,Q,l as V,R as W,S as X,T as Z,U as j,V as ee,f as te,b as se,W as ae,X as re,Y as ie}from"./qSG3srHc.js";class ne{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,s=!0){this.anchor=e,this.#r=s}#i=()=>{var e=R;if(this.#t.has(e)){var s=this.#t.get(e),t=this.#s.get(s);if(t)L(t),this.#a.delete(s);else{var n=this.#e.get(s);n&&(this.#s.set(s,n.effect),this.#e.delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),t=n.effect)}for(const[a,i]of this.#t){if(this.#t.delete(a),a===e)break;const r=this.#e.get(i);r&&(S(r.effect),this.#e.delete(i))}for(const[a,i]of this.#s){if(a===s||this.#a.has(a))continue;const r=()=>{if(Array.from(this.#t.values()).includes(a)){var h=document.createDocumentFragment();B(i,h),h.append(T()),this.#e.set(a,{effect:i,fragment:h})}else S(i);this.#a.delete(a),this.#s.delete(a)};this.#r||!t?(this.#a.add(a),M(i,r,!1)):r()}}};#n=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[t,n]of this.#e)s.includes(t)||(S(n.effect),this.#e.delete(t))};ensure(e,s){var t=R,n=N();if(s&&!this.#s.has(e)&&!this.#e.has(e))if(n){var a=document.createDocumentFragment(),i=T();a.append(i),this.#e.set(e,{effect:I(()=>s(i)),fragment:a})}else this.#s.set(e,I(()=>s(this.anchor)));if(this.#t.set(t,e),n){for(const[r,c]of this.#s)r===e?t.unskip_effect(c):t.skip_effect(c);for(const[r,c]of this.#e)r===e?t.unskip_effect(c.effect):t.skip_effect(c.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else P&&(this.anchor=w),this.#i()}}function ue(f,e,s=!1){P&&Y();var t=new ne(f),n=s?x:0;function a(i,r){if(P){const h=F(f)===C;if(i===h){var c=U();q(c),t.anchor=c,y(!1),t.ensure(i,r),y(!0);return}}t.ensure(i,r)}k(()=>{var i=!1;e((r,c=!0)=>{i=!0,a(c,r)}),i||a(!1,null)},n)}let b=!1;function fe(f){var e=b;try{return b=!1,[f(),b]}finally{b=e}}function he(f,e,s,t){var n=!V||(s&W)!==0,a=(s&X)!==0,i=(s&ie)!==0,r=t,c=!0,h=()=>(c&&(c=!1,r=i?se(t):t),r),_;if(a){var p=j in f||ee in f;_=z(f,e)?.set??(p&&e in f?u=>f[e]=u:void 0)}var o,A=!1;a?[o,A]=fe(()=>f[e]):o=f[e],o===void 0&&t!==void 0&&(o=h(),_&&(n&&ae(),_(o)));var d;if(n?d=()=>{var u=f[e];return u===void 0?h():(c=!0,u)}:d=()=>{var u=f[e];return u!==void 0&&(r=void 0),u===void 0?r:u},n&&(s&G)===0)return d;if(_){var O=f.$$legacy;return(function(u,v){return arguments.length>0?((!n||!v||O||A)&&_(v?d():u),u):d()})}var g=!1,l=((s&re)!==0?te:Q)(()=>(g=!1,d()));a&&m(l);var D=J;return(function(u,v){if(arguments.length>0){const E=v?m(l):n&&a?H(u):u;return $(l,E),g=!0,r!==void 0&&(r=E),u}return Z&&g||(D.f&K)!==0?l.v:m(l)})}export{ne as B,ue as i,he as p};
